## Типове целост на данните (Data Integrity):

- Domain Integrity – определя позволените стойности в колоните.

- Entity Integrity – гарантира, че всеки ред в таблица е уникално идентифициран чрез първичен ключ (primary key).

- Referential Integrity – определя и поддържа връзките между таблиците (чрез външни ключове).
---------------
## Домейн целостта се осигурява чрез:

- Data Types – определят какъв тип данни могат да се съхраняват в дадена колона (напр. INT, VARCHAR, DATE).

- DEFAULT Constraints – задават стойност по подразбиране, ако не е въведена друга.

- CHECK Constraints – ограничават допустимите стойности в колоната (напр. CHECK (age > 0)).

- Demonstration – показва прилагането на тези правила за гарантиране на точни и валидни данни.
---------------
## DEFAULT Constraints (Ограничения по подразбиране):

- Осигуряват стойности по подразбиране за колони.

- Използват се, когато INSERT заявката не задава стойност за колоната.

- Стойността по подразбиране трябва да е съвместима с типа данни на колоната.
-----------------
## Primary Key (Първичен ключ)

- Уникално идентифицира всеки ред в таблица

- Стойностите трябва да са уникални и не NULL

- Може да бъде съставен от няколко колони (composite key)
-------------------
## UNIQUE Constraints (Ограничения за уникалност)

- Гарантират, че стойностите в дадена колона са уникални

- Позволяват единствен NULL запис

- В една таблица може да има няколко UNIQUE колони
--------------------
## IDENTITY Property (Свойство за автоматично генериране)

- Автоматично генерира стойности за колона

- Може да се зададе начална стойност (seed) и стъпка (increment)

- Стандартните стойности са seed = 1 и increment = 1 (брояч)

- SCOPE_IDENTITY() и @@IDENTITY връщат последната генерирана стойност
-------------------
## Sequence Objects (Обекти-последователности)

- Потребителски дефинирани обекти в схемата

- Не са свързани с конкретна таблица

- Улесняват миграцията от други системи за управление на бази данни
-------------------
разлика между identity and sequence: sequence-повече таблици), главно ползваме identity

Sequences генерират последователни числови стойности, които не са свързани с конкретна таблица, за разлика от IDENTITY. Те позволяват споделяне на последователности между множество таблици и поддържат цикличност, кеширане и контролирани диапазони от стойности.
--------------------
## FOREIGN KEY Constraints (Ограничения за външен ключ):

- Свързват две таблици, като създават връзка между тях

- Референцията трябва да сочи към PRIMARY KEY или UNIQUE колона

- Референцията не може да бъде към NULL стойност

- Поддържат саморефериращи се връзки (същата таблица)

- Винаги се препоръчва да се задава име на ограничението
---------------------
## Cascading Referential Integrity (Каскадна референтна цялост):

- Автоматично актуализира или изтрива свързани записи при промяна на PRIMARY KEY

- Действията се дефинират отделно за UPDATE и DELETE:

  - NO ACTION (по подразбиране) - забранява промяната, ако има свързани записи

  - CASCADE - автоматично актуализира/изтрива свързаните записи

  - SET DEFAULT - задава стойност по подразбиране на свързаните записи

  - SET NULL - задава NULL на свързаните записи

*Внимание: CASCADE може да причини непредвидени масови изтривания, затова се използва внимателно.*

----------------------------------------------
## JOIN операции - Основни понятия:

- FROM клаузата определя изходните таблици за заявката

- Резултатът от FROM е виртуална таблица, която се обработва от другите клаузи

- JOIN операциите комбинират редове от две или повече таблици

- Cartesian Product (Декартово произведение) - всеки ред от първата таблица се комбинира с всеки ред от втората

## Основни типове JOIN:

- INNER JOIN - само съвпадащи редове

- OUTER JOIN - включва и несъвпадащи редове

- CROSS JOIN - декартово произведение

- SELF JOIN - join на таблица със самата себе си

--------------
### Cartesian Product (Декартово произведение) 
представлява комбинация от всички редове на една таблица с всички редове на друга таблица.
````
Пример:

Таблица 1: 3 реда

Таблица 2: 2 реда

Резултат: 3 × 2 = 6 реда
````
Това обикновено не е желания резултат в заявките, защото създава огромен брой редове и води до проблеми с производителността.

-----------------
## Основни типове JOIN операции:

- CROSS JOIN

  - Комбинира всички редове от двете таблици

  - Създава декартово произведение

  - Рядко се използва

- INNER JOIN

  - Връща само съвпадащите редове от двете таблици

  - Най-често използвания тип join

- OUTER JOIN

  - Запазва всички редове от едната таблица
  
  - Добавя NULL стойности при липса на съвпадение

  - Видове: LEFT, RIGHT, FULL

---------------
**Синтаксис за JOIN в T-SQL:**

**ANSI SQL-92 (модерен, препоръчителен)**
```sql
SELECT *
FROM Table1 JOIN Table2 
ON Table1.id = Table2.id
```
- Ясен и четим синтаксис
- ON клаузата е задължителна
- Предотвратява случайни Cartesian products

**ANSI SQL-89 (стар, несе препоръчва)**
```sql
SELECT *
FROM Table1, Table2
WHERE Table1.id = Table2.id
```
- Когато забравите WHERE клаузата, получавате **Cartesian product**
- По-труден за четене и поддръжка

**Препоръка**: Винаги използвайте **ANSI SQL-92** синтаксиса.

**INNER JOIN примери:**

**Join по един атрибут:**
```sql
SELECT c.categoryid, c.categoryname, p.productid, p.productname
FROM Production.Categories AS c
JOIN Production.Products AS p
ON c.categoryid = p.categoryid;
```
- Свързва таблици по categoryid
- Показва продукти с техните категории

**Composite join (по няколко атрибута):**
```sql
SELECT DISTINCT e.city, e.country
FROM Sales.Customers AS c
JOIN HR.Employees AS e
ON c.city = e.city AND c.country = e.country;
```
- Свързва по два атрибута: град и държава
- DISTINCT премахва дублиращите се градове

**Join на три таблици:**
```sql
SELECT c.custid, c.companyname, o.orderid, od.productid, od.qty
FROM Sales.Customers AS c
JOIN Sales.Orders AS o ON c.custid = o.custid
JOIN Sales.OrderDetails AS od ON o.orderid = od.orderid;
```
- Каскадно свързване на клиенти, поръчки и детайли

-------------
проблем на DEMO-то : две таблиьи с еднакви колони, трябва да можем да различим коя колона откъде е 
за INNER няма значение от коя страна 
OUTER - с посоки LEFT JOIN + RIGHT JOIN
CROSS - декартово уравнение 
---------------
## OUTER JOIN:

- Връща всички редове от едната таблица + съвпадащи от другата

- При липса на съвпадение се попълва с NULL

- Видове: LEFT (лявата таблица), RIGHT (дясната), FULL (и двете)

Пример: Всички клиенти + техните поръчки (дори клиенти без поръчки)
